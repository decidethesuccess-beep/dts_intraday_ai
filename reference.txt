src/ai_module.py
src/ai_webhook.py
src/backtest_dashboard.py
src/backtest_runner.py
src/constants.py
src/data_fetcher.py
src/intraday_dashboard_GPT.py
src/live_stream.py
src/order_manager.py
src/paper_trade_system.py
src/strategy.py
src/utils.py
src/angel_order.py
src/config.py
src/news_filter.py
src/redis_store.py
tests/test_backtest.py
tests/test_live_stream.py
tests/test_strategy.py
tests/test_strategy_ai.py
tests/test_utils.py
tests/test_integration.py

Advisory: Always follow my strategy_spec.md and .env when discussing trade logic.

this is my old working <file name.py> fyr. pls go through it and give me the updated code accordingly

python -m pytest tests -v
python -m pytest -k test_stop_loss_exit -v
python -m pytest -k test_capital_rotation -v
python -m pytest -k test_target_exit -v
python -m pytest -k test_trend_reversal_exit -v
python -m pytest -k test_autoclose_exit -v
python -m pytest -k test_max_active_positions -v

pytest command template for all your existing tests, so you can run them in one go: python -m pytest tests/test_strategy.py -k "test_stop_loss_exit or test_target_exit or test_trend_reversal_exit or test_autoclose_exit or test_max_active_positions or test_capital_rotation" -v

FYR - Current Module List (Final for DTS Intraday AI Strategy)
ai_module.py – AI scoring, AI-driven optimization, TSL adjustments, trend-flip exit calculations, min-profit mode.
ai_webhook.py – Sends/receives daily/weekly/monthly/yearly AI guidance via Gemini AI Studio.
backtest_dashboard.py – Streamlit/visualization dashboard for backtest results.
backtest_runner.py – Historical 1-min candle backtesting engine, top gainers filtering, trade simulation.
constants.py – Thresholds, TSL/SL/TGT, AI params, capital allocation constants.
data_fetcher.py – Angel One API: 1-min OHLCV, LTP retrieval, NSE EQ static JSON loader, holiday calendar awareness.
intraday_dashboard_GPT.py – Streamlit dashboard for live trading; AI comments, signals, PnL visualization from Redis.
live_stream.py – Real-time LTP/market feed ingestion from Angel One into Redis.
order_manager.py – Sends orders via Angel One API, integrates with paper/live trading, applies capital rotation, SL/TGT/TSL.
paper_trade_system.py – Paper trading simulation: AI TSL, trend flip exits, capital rotation, both BUY/SELL trades.
strategy.py – Main intraday strategy logic: AI scoring, trend detection, trade entry/exit rules, hard SL/TGT, news filter integration.
utils.py – Helper functions: datetime, percentage calculations, symbol filtering, logging helpers.
angel_order.py – Replacement for deprecated dhan_order.py, communicates with Angel One API for live orders.
config.py – Environment configuration, API keys/secrets, trading session settings.
news_filter.py – News sentiment analysis with thresholds, filters negative news for BUY trades.
redis_store.py – Redis central memory hub: AI comments, trade logs, live signals, dashboard updates.
test_backtest.py – Unit/integration tests for backtesting logic.
test_live_stream.py – Unit/integration tests for live data ingestion & streaming.
test_strategy.py – Unit/integration tests for strategy logic: trade signals, AI scoring, TSL, SL/TGT.
test_strategy_ai.py - Start simple (basic fixtures, test AI scoring and TSL adjustments) and expand gradually.
test_utils.py – Unit tests for utilities/helpers.
test_integration.py - An integration test ensures that capital allocation, trade entry/exit, TSL, trend-flip, and PnL all work together with no broken assumptions.

PS D:\dts_intraday_ai> dir 
    Directory: D:\dts_intraday_ai
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         8/23/2025  11:16 PM                .pytest_cache
d-----         8/23/2025  11:17 PM                .venv
d-----         8/23/2025  11:17 PM                .vscode
d-----         8/23/2025  11:17 PM                data
d-----         8/23/2025  11:17 PM                OLD working files
d-----         8/24/2025   9:55 AM                src
d-----         8/23/2025  11:17 PM                tests
-a----         8/15/2025   3:19 PM           3317 .env
-a----         8/15/2025   2:44 PM           2537 .env.example
-a----         8/17/2025   9:06 AM             14 .gitignore
-a----         8/16/2025   8:05 PM            505 debug.md
-a----         8/18/2025   9:29 PM           3949 Dynamic_Checklist.md
-a----         8/17/2025   9:55 AM           1289 Local_and_GitHub_workflow.md
-a----         8/13/2025   9:47 PM           2933 Next Development Roadmap.md
-a----         8/13/2025   9:19 PM           5924 OLD strategy_spec.md
-a----         8/23/2025   8:00 PM           1782 Project Context.md
-a----         8/17/2025   1:44 PM            598 README.md
-a----         8/23/2025  11:01 PM           3378 reference.txt
-a----         8/17/2025   1:19 PM             52 requirements-dev.in
-a----         8/17/2025   1:15 PM            249 requirements.in
-a----         8/18/2025   9:28 PM            248 requirements.txt
-a----         8/15/2025   4:19 PM           6920 strategy_spec - old.md
-a----         8/19/2025   7:57 PM           5077 strategy_spec.md
-a----         8/20/2025   9:39 PM           1023 Test_Error_Fix_Record.md

PS D:\dts_intraday_ai\tests> dir
    Directory: D:\dts_intraday_ai\tests
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         8/23/2025  11:17 PM                .pytest_cache
d-----         8/24/2025   9:52 AM                __pycache__
-a----         8/11/2025   9:51 PM              6 .gitkeep
-a----         8/24/2025   9:48 AM           4631 test_backtest.py
-a----         8/16/2025   9:57 PM           2152 test_backtest_setup.py
-a----         8/24/2025   9:51 AM           6544 test_integration.py
-a----         8/15/2025   7:24 PM           2446 test_live_stream.py
-a----         8/20/2025   8:31 PM          13806 test_strategy.py
-a----         8/18/2025  10:37 PM           3586 test_utils.py
-a----         8/12/2025   7:25 PM              0 __init__.py
PS D:\dts_intraday_ai\src> dir
    Directory: D:\dts_intraday_ai\src
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         8/24/2025   9:55 AM                .pytest_cache
d-----         8/23/2025  11:17 PM                __pycache__
-a----         8/15/2025   8:01 AM           3926 .env
-a----         8/11/2025   9:51 PM              6 .gitkeep
-a----         8/19/2025  10:33 PM           4755 ai_module.py
-a----         8/15/2025   7:11 PM           4707 ai_webhook.py
-a----         8/15/2025   7:17 PM           3826 angel_order.py
-a----         8/15/2025   7:12 PM           2611 backtest_dashboard.py
-a----         8/18/2025  10:21 PM           3197 backtest_runner.py
-a----         8/18/2025  10:13 PM           2836 config.py
-a----         8/20/2025   7:54 PM           1963 constants.py
-a----         8/15/2025   9:38 PM           3177 data_fetcher.py
-a----         8/12/2025   7:25 PM              0 dhan_order.py
-a----         8/15/2025   7:12 PM           3198 intraday_dashboard_GPT.py
-a----         8/18/2025  10:25 PM           3070 live_stream.py
-a----         8/15/2025   7:13 PM           3545 news_filter.py
-a----         8/19/2025   9:34 PM           5987 order_manager.py
-a----         8/15/2025   7:08 PM           4629 paper_trade_system.py
-a----         8/15/2025   7:09 PM           5851 redis_store.py
-a----         8/20/2025   8:34 PM           8514 strategy.py
-a----         8/18/2025  10:46 PM           2428 utils.py
-a----         8/12/2025   7:25 PM              0 __init__.py





